{"version":3,"file":"Visible.stories-e6bd5e39.js","sources":["../../src/components/Visible/stories/docs/component.md?raw","../../src/components/Visible/stories/snippets/default.svelte?raw","../../src/components/Visible/Visible.svelte","../../src/components/Visible/Visible.stories.svelte"],"sourcesContent":["export default \"Wrap components or other HTML elements to determine if they are visible on the page using the [Intersection Observer API](https://developer.mozilla.org/en-US/docs/Web/API/Intersection_Observer_API).\\n\\nThis is really useful for lazy loading elements, especially expensive media files or components that fetch lots of data. You can also use it trigger animations or play media once a reader scrolls a component into view.\\n\\n> **Pro tip:** Don't use this for content that's \\\"above the fold\\\" at the top of the page. That'll just slow down the first load of important visible content.\\n\\n```svelte\\n<script>\\n  import { Visible } from '@reuters-graphics/graphics-components';\\n</script>\\n\\n<Visible let:visible>\\n  {#if visible}\\n    <p>Visible!</p>\\n  {:else}\\n    <p>Not yet visible.</p>\\n  {/if}\\n</Visible>\\n```\\n\"","export default \"<script>\\n  import { Visible } from '@reuters-graphics/graphics-components';\\n</script>\\n\\n<Visible let:visible>\\n  {#if visible}\\n    <p>Visible!</p>\\n  {:else}\\n    <p>Not yet visible.</p>\\n  {/if}\\n</Visible>\\n\"","<!-- @component `Visible` [Read the docs.](https://reuters-graphics.github.io/graphics-components/?path=/docs/components-Visible--default) -->\n<script lang=\"ts\">\n  import { onMount } from 'svelte';\n  /**\n   * Whether to change visibility just once.\n   *\n   * Useful for loading expensive images or other media and then keeping them around once they're first loaded.\n   */\n  export let once: boolean = false;\n  /** Set Intersection Observer [rootMargin](https://developer.mozilla.org/en-US/docs/Web/API/Intersection_Observer_API#rootmargin) `top`. */\n  export let top = 0;\n  /** Set Intersection Observer [rootMargin](https://developer.mozilla.org/en-US/docs/Web/API/Intersection_Observer_API#rootmargin) `bottom`. */\n  export let bottom = 0;\n  /** Set Intersection Observer [rootMargin](https://developer.mozilla.org/en-US/docs/Web/API/Intersection_Observer_API#rootmargin) `left`. */\n  export let left = 0;\n  /** Set Intersection Observer [rootMargin](https://developer.mozilla.org/en-US/docs/Web/API/Intersection_Observer_API#rootmargin) `right`. */\n  export let right = 0;\n  /** Set the Intersection Observer [threshold](https://developer.mozilla.org/en-US/docs/Web/API/Intersection_Observer_API#threshold). */\n  export let threshold = 0;\n\n  let visible = false;\n  let container: HTMLElement;\n\n  onMount(() => {\n    if (typeof IntersectionObserver !== 'undefined') {\n      const rootMargin = `${bottom}px ${left}px ${top}px ${right}px`;\n      const observer = new IntersectionObserver(\n        (entries) => {\n          visible = entries[0].isIntersecting;\n          if (visible && once) {\n            observer.unobserve(container);\n          }\n        },\n        {\n          rootMargin,\n          threshold,\n        }\n      );\n      observer.observe(container);\n      return () => observer.unobserve(container);\n    }\n    function handler() {\n      const bcr = container.getBoundingClientRect();\n      visible =\n        bcr.bottom + bottom > 0 &&\n        bcr.right + right > 0 &&\n        bcr.top - top < window.innerHeight &&\n        bcr.left - left < window.innerWidth;\n      if (visible && once) {\n        window.removeEventListener('scroll', handler);\n      }\n    }\n    window.addEventListener('scroll', handler);\n    return () => window.removeEventListener('scroll', handler);\n  });\n</script>\n\n<div bind:this=\"{container}\">\n  <!-- An element or component -->\n  <slot visible=\"{visible}\" />\n</div>\n","<script>\n  import { Meta, Template, Story } from '@storybook/addon-svelte-csf';\n\n  // @ts-ignore\n  import componentDocs from './stories/docs/component.md?raw';\n  // @ts-ignore\n  import defaultSnippet from './stories/snippets/default.svelte?raw';\n\n  import Visible from './Visible.svelte';\n\n  import { withSource, withComponentDocs } from '$lib/docs/utils/withParams.js';\n</script>\n\n<Meta\n  title=\"Components/Visible\"\n  component=\"{Visible}\"\n  {...withComponentDocs(componentDocs)}\n/>\n\n<Template let:args>\n  <Visible {...args} let:visible>\n    {#if visible}\n      <p>Visible!</p>\n    {:else}\n      <p>Not yet visible.</p>\n    {/if}\n  </Visible>\n</Template>\n\n<Story name=\"Default\" {...withSource({ svelte: defaultSnippet })} />\n"],"names":["componentDocs","defaultSnippet","ctx","insert","target","div","anchor","once","$$props","top","bottom","left","right","threshold","visible","container","onMount","rootMargin","observer","entries","$$invalidate","handler","bcr","$$value","p","create_if_block","Visible","withComponentDocs","withSource"],"mappings":"mVAAA,MAAeA,EAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,ECAAC,EAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,sCC2DGC,EAAO,CAAA,CAAA,qGAFzBC,EAGKC,EAAAC,EAAAC,CAAA,qOApDQ,CAAA,KAAAC,EAAgB,EAAK,EAAAC,EAErB,CAAA,IAAAC,EAAM,CAAC,EAAAD,EAEP,CAAA,OAAAE,EAAS,CAAC,EAAAF,EAEV,CAAA,KAAAG,EAAO,CAAC,EAAAH,EAER,CAAA,MAAAI,EAAQ,CAAC,EAAAJ,EAET,CAAA,UAAAK,EAAY,CAAC,EAAAL,EAEpBM,EAAU,GACVC,EAEJC,EAAO,IAAA,CACM,GAAA,OAAA,qBAAyB,IAAW,CACvC,MAAAC,KAAgBP,CAAM,MAAMC,CAAI,MAAMF,CAAG,MAAMG,CAAK,KACpDM,EAAQ,IAAO,qBAClBC,GAAO,CACNC,EAAA,EAAAN,EAAUK,EAAQ,CAAC,EAAE,cAAc,EAC/BL,GAAWP,GACbW,EAAS,UAAUH,CAAS,GAI9B,CAAA,WAAAE,EACA,UAAAJ,CAAS,CAAA,EAGb,OAAAK,EAAS,QAAQH,CAAS,MACbG,EAAS,UAAUH,CAAS,WAElCM,GAAO,OACRC,EAAMP,EAAU,wBACtBK,EAAA,EAAAN,EACEQ,EAAI,OAASZ,EAAS,GACtBY,EAAI,MAAQV,EAAQ,GACpBU,EAAI,IAAMb,EAAM,OAAO,aACvBa,EAAI,KAAOX,EAAO,OAAO,UAAU,EACjCG,GAAWP,GACb,OAAO,oBAAoB,SAAUc,CAAO,EAGhD,cAAO,iBAAiB,SAAUA,CAAO,EAC5B,IAAA,OAAO,oBAAoB,SAAUA,CAAO,6CAI5CN,EAASQ;;ihECjCpBpB,EAAsBC,EAAAoB,EAAAlB,CAAA,4FAFtBH,EAAcC,EAAAoB,EAAAlB,CAAA,8DADXJ,EAAO,CAAA,EAAAuB,qMADDvB,EAAI,CAAA,CAAA,sOAAJA,EAAI,CAAA,CAAA,CAAA,CAAA,gNALLwB,CAAO,EACfC,EAAkB3B,CAAa,iMAaX4B,EAAU,CAAG,OAAQ3B,CAAc,CAAA,CAAA;;;;;;"}